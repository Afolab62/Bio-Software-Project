// Core types for the Direct Evolution Monitoring Portal

export interface User {
  id: string;
  email: string;
  passwordHash: string;
  createdAt: Date;
}

export interface UniProtProtein {
  accession: string;
  name: string;
  organism: string;
  sequence: string;
  length: number;
  features: UniProtFeature[];
}

export interface UniProtFeature {
  type: string;
  description: string;
  location: {
    start: number;
    end: number;
  };
}

export interface Experiment {
  id: string;
  userId: string;
  name: string;
  proteinAccession: string;
  proteinName?: string | null;
  protein: UniProtProtein | null;
  wtProteinSequence?: string;
  proteinFeatures?: any;
  plasmidSequence: string;
  plasmidName: string;
  validationStatus: "pending" | "valid" | "invalid";
  validationMessage: string;
  createdAt: Date;
  updatedAt: Date;
}

export interface VariantData {
  id: string;
  experimentId: string;
  plasmidVariantIndex: number;
  parentPlasmidVariant: number | null;
  generation: number;
  assembledDNASequence: string;
  proteinSequence: string;
  dnaYield: number;
  proteinYield: number;
  fluorescence: number;
  activityScore: number;
  isControl: boolean;
  mutations: Mutation[];
  qcStatus: "passed" | "failed";
  qcMessage: string;
  metadata: Record<string, unknown>;
}

export interface Mutation {
  position: number;
  wildType: string;
  mutant: string;
  type: "synonymous" | "non-synonymous";
  generation: number;
}

export interface ParseResult {
  success: boolean;
  variants: VariantData[];
  errors: ParseError[];
  warnings: string[];
}

export interface ParseError {
  row: number;
  field: string;
  message: string;
}

export interface AnalysisResult {
  topPerformers: VariantData[];
  generationStats: GenerationStats[];
  totalVariants: number;
  passedQC: number;
  failedQC: number;
}

export interface GenerationStats {
  generation: number;
  count: number;
  meanActivity: number;
  medianActivity: number;
  minActivity: number;
  maxActivity: number;
  stdDev: number;
}
